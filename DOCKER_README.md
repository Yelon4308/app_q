# Інструкція з запуску контейнеру для сервера синхронізації

## Підготовка

Сервер синхронізації малювання та оновлень для додатку "Штаб на пожежі" можна легко запустити за допомогою Docker. Це забезпечить ізольоване середовище та спростить розгортання.

## Вимоги

- Встановлений Docker (https://docs.docker.com/get-docker/)
- Встановлений Docker Compose (https://docs.docker.com/compose/install/)

## Кроки для запуску

### 1. Клонування репозиторію (якщо ви ще цього не зробили)

```bash
git clone <url-до-репозиторію-з-сервером>
cd server
```

### 2. Конфігурація

Відредагуйте файл `config.py` для налаштування параметрів сервера. У більшості випадків значення за замовчуванням підходять, але ви можете змінити:

- `HOST` - для вказання конкретного інтерфейсу (за замовчуванням: "0.0.0.0")
- `PORT` - для зміни порту (за замовчуванням: 8000)
- `DEBUG` - для відключення режиму налагодження у продакшені (змініть на False)

### 3. Запуск за допомогою Docker Compose

```bash
docker-compose up -d
```

Це запустить контейнер сервера у фоновому режимі.

### 4. Перевірка роботи

```bash
docker-compose logs -f
```

Ця команда покаже логи сервера. Ви повинні побачити повідомлення про успішний запуск.

Також ви можете відкрити браузер за адресою:
```
http://<ваш-ip>:8000
```

Ви повинні побачити головну сторінку сервера синхронізації.

### 5. Зупинка сервера

```bash
docker-compose down
```

## Управління даними

Docker контейнер налаштований на збереження даних у локальних директоріях:

- `./static` - для файлів оновлень
- `./drawing_sync.db` - для бази даних SQLite

Це дозволяє зберігати дані навіть після перезапуску контейнера.

## Налаштування для продакшену

Для використання у продакшені рекомендується:

1. Змінити `DEBUG = False` у файлі `config.py`
2. Використовувати HTTPS (розкоментуйте відповідні налаштування в `nginx.conf`)
3. Налаштувати автоматичний перезапуск контейнера при перезавантаженні сервера:

```bash
docker update --restart=always drawing-sync-server
```

## Оновлення сервера

Для оновлення до нової версії сервера:

```bash
# Зупинити поточний контейнер
docker-compose down

# Отримати останні зміни з репозиторію
git pull

# Перезібрати та запустити контейнер
docker-compose up -d --build
```
